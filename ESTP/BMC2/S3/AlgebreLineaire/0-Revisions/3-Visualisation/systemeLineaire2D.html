<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Systèmes linéaires - Visualisation</title>
  <style>
    html, body { height: 100%; margin: 0; background: transparent; }
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      background: transparent;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
    }
    .page { 
      display: flex; 
      flex-direction: column;
      align-items: center; 
      gap: 20px; 
      padding: 16px; 
      background: transparent; 
    }
    .content {
      display: flex;
      align-items: flex-start;
      gap: 20px;
    }
    #container {
      position: relative;
      width: 800px;
      height: 600px;
      overflow: hidden;
      border: 1px solid #ccc;
      border-radius: 8px;
      background: white;
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
    }
    #panel {
      width: 300px;
      height: 600px;
      padding: 12px;
      border-radius: 10px;
      background: #fafafa;
      border: 1px solid rgba(0,0,0,0.08);
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
      overflow: auto;
    }
    .eq-block {
      margin-bottom: 10px;
      padding: 6px;
      border-bottom: 1px solid #ddd;
    }
    input {
      width: 40px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="title-container">
      <h1>Systèmes linéaires interactifs</h1>
    </div>
    <div class="content">
      <div id="container"></div>
      <div id="panel">
        <h3>Équations</h3>
        <div id="equations"></div>
        <button onclick="addEquation()">Ajouter une équation</button>
      </div>
    </div>
  </div>

  <!-- p5.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <script>
    let equations = [
      {a: 3, b: 2, c: 7},
      {a: 1, b: -1, c: -1}
    ];
    let canvas;

    function setup() {
      canvas = createCanvas(800, 600);
      canvas.parent("container");
      updatePanel();
    }

    function draw() {
      background(255);
      drawGrid();

      // tracer les droites
      strokeWeight(3);
      equations.forEach((eq, idx) => {
        stroke(color(50 + idx*80, 100, 200));
        drawLine(eq.a, eq.b, eq.c);
      });
    }

    function drawGrid() {
      stroke(220);
      strokeWeight(1);
      for (let x = 0; x < width; x += 40) {
        line(x, 0, x, height);
      }
      for (let y = 0; y < height; y += 40) {
        line(0, y, width, y);
      }
      stroke(0);
      strokeWeight(1);
      // axes
      line(width/2, 0, width/2, height);
      line(0, height/2, width, height/2);
      // flèches des axes
      // flèche en haut de l'axe vertical (vers le haut)
      line(width/2, 0, width/2 - 8, 12);
      line(width/2, 0, width/2 + 8, 12);
      // flèche à droite de l'axe horizontal (vers la droite)
      line(width, height/2, width - 12, height/2 - 8);
      line(width, height/2, width - 12, height/2 + 8);
    }

    function drawLine(a, b, c) {
      // équation : ax + by = c
      // points aux extrémités du canvas
      let x1 = -width/2, x2 = width/2;
      let y1, y2;

      if (b !== 0) {
        y1 = (c - a*x1) / b;
        y2 = (c - a*x2) / b;
        line(toCanvasX(x1), toCanvasY(y1), toCanvasX(x2), toCanvasY(y2));
      } else {
        // verticale
        let x = c/a;
        line(toCanvasX(x), 0, toCanvasX(x), height);
      }
    }

    function toCanvasX(x) {
      return width/2 + x*40;
    }

    function toCanvasY(y) {
      return height/2 - y*40;
    }

    function updatePanel() {
      let container = document.getElementById("equations");
      container.innerHTML = "";
      equations.forEach((eq, idx) => {
        let div = document.createElement("div");
        div.className = "eq-block";
        div.innerHTML = `
          <label>${idx+1}) </label>
          <input type="number" value="${eq.a}" onchange="updateEquation(${idx}, 'a', this.value)"> x +
          <input type="number" value="${eq.b}" onchange="updateEquation(${idx}, 'b', this.value)"> y =
          <input type="number" value="${eq.c}" onchange="updateEquation(${idx}, 'c', this.value)">
          <button onclick="removeEquation(${idx})">x</button>
        `;
        container.appendChild(div);
      });
    }

    function updateEquation(idx, key, val) {
      equations[idx][key] = parseFloat(val);
    }

    function addEquation() {
      equations.push({a: 1, b: 1, c: 1});
      updatePanel();
    }

    function removeEquation(idx) {
      equations.splice(idx, 1);
      updatePanel();
    }
  </script>
</body>
</html>
